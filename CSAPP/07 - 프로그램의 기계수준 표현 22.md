# 프로그램의 기계수준 표현 2/2



## 5. 산술연산과 논리연산

연산들은 네 개의 그룹으로 나누어진다: 유효주소 적재, 단항(unary), 이항(binary), 쉬프트

### - 유효주소 적재(Load Effective Address)

| Instruction  | Effect | Description            |
| ------------ | ------ | ---------------------- |
| leaq    S, D | D ← &S | Load effective address |

**유효주소 적재** 인스트럭션 `leaq`는 실제로는 `movq` 인스터럭션의 변형이다. 그러므로 메모리에서 레지스터로 읽어 들이는 형태를 갖지만, 메모리를 전혀 참조하지 않는다. 가리키는 값(유효주소)을 목적지에 복사할 뿐이다. 주로 나중의 메모리 참조에 사용하게 되는 포인터를 생성하기 위해 사용한다. 목적 주소(D)에는 오직 레지스터만 올 수 있다. 

### - 단항 및 이항 연산

| Instruction  | Effect     | Description  |
| ------------ | ---------- | ------------ |
| INC    D     | D ← D + 1  | Increament   |
| DEC    D     | D ← D - 1  | Decrement    |
| NEG    D     | D ← -D     | Negate       |
| NOT    D     | D ← ~D     | Complemnt    |
|              |            |              |
| ADD    S, D  | D ← D + S  | Add          |
| SUB    S, D  | D ← D - S  | Subtract     |
| IMUL    S, D | D ← D * S  | Multiply     |
| XOR    S, D  | D ← D ^ S  | Exclusive-or |
| OR    S, D   | D ← D \| S | Or           |
| AND    S, D  | D ← D & S  | And          |

오퍼랜드 길이에 따른 다양한 변형이 가능하기 때문에 클래스에 따라 나열하였다. 단항 연산의 오퍼랜드는 레지스터나 메모리 위치가 될 수 있다. 예를 들면, `incq(%rsp`는 스택 탑의 8바이트 원소의 값을 증가시켜준다. 이 문법은 C에서의 증가(++)와 감소(—)연산자를 연상시킨다.

이항 연산의 두 번째 오퍼랜드(D)는 소스이면서 목적지로 사용된다. 이 문법은 C에서의 할당 연산자인 `x-=y` 같은 문장과 유사하다. 첫 번째 오퍼랜드는 상수나 레지스터, 메모리 위치가 올 수 있다. 두 번째는 레지스터나 메모리가 올 수 있다. `MOV` 처럼 두 개의 오퍼랜드가 모두 메모리 위치가 될 수 없다. 두번 째 오퍼랜드가 메모리 위치일 때 프로세서가 메모리에서 값을 읽고, 연산을 하고, 그 결과를 다시 메모리에 써야 한다는 점에 유의해야 한다.

### - 쉬프트 연산

| Instruction | Effect      | Description              |
| ----------- | ----------- | ------------------------ |
| SAL    k, D | D ← D << k  | Left shift               |
| SHL    k, D | D ← D << k  | Left shift (same as SAL) |
| SAR    k, D | D ← D >> Ak | Arithmetic right shift   |
| SHR    k, D | D ← D >> Lk | Logical right shift      |

쉬프트 연산은 쉬프트하는 크기를 먼저 주고, 쉬프트할 값을 두 번째로 준다. 산술과 논리형 우측 쉬프트가 모두 가능하다. 좌측 쉬프트 인스트럭션 `SAL`과 `SHL`은 같은 효과를 내며, 우측에서부터 0을 채운다. 우측 쉬프트 인스트럭션 `SHR`은 논리 쉬프트로써 좌측으로 부터 0으로 채우는 반면, `SAR` 은 산술 쉬프트로 부호 비트를 복사해서 채운다. 쉬프트 연산의 목적 오퍼랜드는 레지스터나 메모리 위치가 될 수 있다.

---

## 6. 제어문

